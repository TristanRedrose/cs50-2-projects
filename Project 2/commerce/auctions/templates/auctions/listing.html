{% extends "auctions/layout.html" %}
{% load humanize %}

{% block body %}
    <h2>Listing: {{ listing.title }}</h2>
    <div class="list-box">
        <div class="auction-box">
            <div class="imagelist-box">
                {% if listing.picture ==  "" %}
                    <image class="l-img" src="https://tacm.com/wp-content/uploads/2018/01/no-image-available.jpeg" alt="no image">
                {% else %}
                    <image class="l-img" src="{{ listing.picture }}" alt="listing image">
                {% endif %}
            </div>
        </div>
        <div class="m-box">
            <h6>{{ listing.description }}</h6>
        </div>
        <div class="m-box">
            <h3>Current price: ${{ listing.bid|intcomma }}</h3>
        </div>
        {% if user.is_authenticated %}
            {% if user.username|upper != listing.creator|upper %}
            <div class="m-box">
                <form action="" method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <input class="form-control" type="number" min="1" name="bid" placeholder="Bid">
                    </div>
                    <input class="btn btn-primary" type="submit" value="Place bid">
            </div>
            {% else %}
            <div class="m-box">
            <a class="btn btn-primary" href="/listing/{{ listing.id }}/close">Close listing</a>
            </div>
            {% endif %}
        {% endif %}
        <div class="m-box">

        </div>
        <div class="m-box">
            <h4>Details:</h4>
            <ul>
                <li>Listed by: {{ listing.creator}}</li>
                <li>Category: {{ listing.ctg }}</li>
                <li>Created: {{ listing.time}}</li>
                {% if listing.active == True %}
                <li>Status: Active</li>
                {% else %}
                <li>Status: Closed</li>
                {% endif %}
            </ul>
        </div>
        <div class="m-box">
            <h4>Comments:</h4>
        </div>
        <div class="comment-box">
            {% for comment in comments %}
                {% if listing.title == comment.subject.title %}
                <div class="c-box">
                <p><strong>{{ comment.writer}}:</strong> {{ comment.comment }}</p>
                </div>
                {% endif %}
            {% endfor %}
        </div>
        {% if user.is_authenticated %}
        <div class="m-box">
            <form action="" method="post">
                {% csrf_token %}
                <div class="form-group">
                    <input type="hidden" name="name" value="{{ user.id }}">
                    <input class="form-control" type="text" min="1" name="comment" placeholder="Write comment">
                </div>
            <input class="btn btn-primary" type="submit" value="Comment">
        </div>
        {% endif %}
    </div>
{% endblock %}